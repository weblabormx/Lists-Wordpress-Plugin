jQuery(function(d){var c=d("#lfa-wrapper");d.fn.serializeObject=function(){var f={};var e=this.serializeArray();d.each(e,function(){if(f[this.name]!==undefined){if(!f[this.name].push){f[this.name]=[f[this.name]]}f[this.name].push(this.value||"")}else{f[this.name]=this.value||""}});return f};var b={};c.find(".choice-template").each(function(f,e){b[e.id]=function(g){return e.innerHTML.replace(/\{\{index\}\}/g,g)}});c.find("> .section .title").click(function(g){g.preventDefault();var f=d(this);f.prev(".tab-state").attr("checked",f.parent().hasClass("collapsed")?true:false);f.next(".content").slideToggle(function(){d(this).parent().toggleClass("collapsed")})});c.on("click","[data-toggler]",function(f){if(this.tagName=="A"){f.preventDefault()}d(this).toggleClass("toggled");d('[data-toggle="'+d(this).data("toggler")+'"]').stop().slideToggle(function(){d(this).toggleClass("toggled")})});c.find(".choice-types button").click(function(g){g.preventDefault();var f=b[d(this).data("template")](d(".choices-container > .choice").length);c.find(".choices-container").append(f).trigger("refresh")});c.find(".choices-container").sortable({axis:"y",items:"> .choice",handle:".choice-controllers .move",cancel:"input",containment:"parent",revert:100,tolerance:"pointer",placeholder:"choice-sortable-placeholder",forceHelperSize:true,forcePlaceholderSize:true,update:function(){c.find(".choices-container > .choice").trigger("refresh")}});c.find(".choices-container").on("refresh",function(){c.find(".choices-container").sortable("refresh");c.find(".choices-container .choice").each(function(e){d("input, select, textarea",this).attr("name",function(){this.name=this.name.replace(/lfa_options\[choices\]\[(\d+)\]/g,function(h,g,f,i){return h.replace(g,e)})})})});c.on("click",".choice .choice-controllers .delete",function(f){f.preventDefault();d(this).closest(".choice").remove();c.find(".choices-container").trigger("refresh")});c.on("click",".choice .choice-controllers .upload",function(f){f.preventDefault();TPMediaUploader.frame().open();d("[data-upload-holder]").removeAttr("data-upload-holder");d(this).closest(".choice").find(".upload-holder").attr("data-upload-holder","")});d(".override-votes").change(function(){d(".choices-container").toggleClass("show-votes-fields")});c.find(".datepicker").each(function(){d(this).datepicker()});if(typeof d.farbtastic=="function"){var a='<div class="lfa-color-picker"></div>';d(".lfa-color-field").focus(function(){d(this).after(a).next(".lfa-color-picker").farbtastic(this).slideDown()}).blur(function(){d(this).next(".lfa-color-picker").slideUp(function(){d(this).remove()})})}else{d(".lfa-color-field").wpColorPicker()}d('select[name="lfa_options[template][preset][name]"]').on("change",function(f){if(confirm("Are you sure?")){d('input[name="lfa_options[template][preset][load]"]').val(d(this).val());d("#publish").click()}else{d(this).val(d(this).find("[selected]").val())}});d('button[name="lfa_options[template][preset][new]"]').on("click",function(f){d(this).val(prompt("Preset ID"))});d('button[name="lfa_options[template][preset][delete]"]').on("click",function(f){if(!confirm("Are you sure?")){f.preventDefault()}});c.on("click",".customizer a[data-toggler]:not(.toggled)",function(f){d(".customizer a.toggled").not(this).click()});TPMediaUploader={frame:function(){if(this._frame){return this._frame}this._frame=wp.media({title:wp.media.view.l10n.insertMediaTitle,multiple:false,library:{type:"image"}});this._frame.on("ready",this.ready);this._frame.state("library").on("select",this.select);return this._frame},ready:function(){d(".media-modal").addClass("no-sidebar smaller")},select:function(){this.get("selection").map(TPMediaUploader.insertImage)},insertImage:function(f){var e=d("[data-upload-holder]").parent();e.find('input[name*="label"]').val(f.get("title"));e.find("[data-upload-holder]").val(f.get("sizes").thumbnail.url);e.find('input[name*="full"]').val(f.get("sizes").full.url)}}});